# 신고하기 팝업창 수정 내역 및 원복 방법

## 작업 일시
2026-01-13

## 작업 목적
iOS App Store 리젝(Guideline 1.2) 대응
- Apple 요구사항: 차단(Block) 기능 명시, 24시간 내 조치 명시

---

## 수정된 파일 목록

### 1. bbs/report_form.php
**백업 파일**: `bbs/report_form.php.backup`

**수정 내역**:
1. **145번 줄**: 제목 수정
   - 변경 전: `<?php echo $target_name; ?> 신고하기`
   - 변경 후: `<?php echo $target_name; ?> 신고하기 / 차단하기`

2. **153번 줄**: 안내 라벨 수정
   - 변경 전: `신고 사유를 선택해주세요`
   - 변경 후: `신고 또는 차단 사유를 선택해주세요`

3. **158번 줄**: HTML5 required 속성 제거 (커스텀 alert를 위해)
   - 변경 전: `<input type="radio" name="reason" value="..." required>`
   - 변경 후: `<input type="radio" name="reason" value="...">`

4. **182번 줄**: 버튼 텍스트 수정
   - 변경 전: `신고하기`
   - 변경 후: `신고 / 차단`

### 2. skin/board/report_basic/view.skin.php
**백업 파일**: `skin/board/report_basic/view.skin.php.backup`

**수정 내역**:
1. **436번 줄**: 댓글 비공개 처리 메시지
   - 변경 전: `신고 누적으로 가려진 댓글입니다. 관리자의 확인 후 복구될 수 있습니다.`
   - 변경 후: `이 콘텐츠는 신고 또는 차단으로 인해 일시적으로 비공개 처리되었습니다. 신고된 콘텐츠는 24시간 내 검토됩니다.`

2. **442번 줄**: 게시글 비공개 처리 메시지
   - 변경 전: `신고 누적으로 가려진 게시글입니다. 관리자의 확인 후 복구될 수 있습니다.`
   - 변경 후: `이 콘텐츠는 신고 또는 차단으로 인해 일시적으로 비공개 처리되었습니다. 신고된 콘텐츠는 24시간 내 검토됩니다.`

3. **482번 줄**: 신고 완료 후 alert 메시지
   - 변경 전: `alert(data.message || '신고가 접수되었습니다.');`
   - 변경 후: `alert('이 콘텐츠가 차단되었습니다.\n차단된 콘텐츠는 즉시 숨김 처리되며\n자동으로 신고되어 24시간 내 검토됩니다.');`

4. **500번 줄**: 유효성 검증 alert 메시지
   - 변경 전: `alert('신고 사유를 선택해주세요.');`
   - 변경 후: `alert('신고 또는 차단 사유를 선택해주세요.');`

### 3. mobile/skin/board/report_basic/view.skin.php
**백업 파일**: `mobile/skin/board/report_basic/view.skin.php.backup`

**수정 내역**:
1. **399번 줄**: 댓글 비공개 처리 메시지
   - 변경 전: `신고 누적으로 가려진 댓글입니다. 관리자의 확인 후 복구될 수 있습니다.`
   - 변경 후: `이 콘텐츠는 신고 또는 차단으로 인해 일시적으로 비공개 처리되었습니다. 신고된 콘텐츠는 24시간 내 검토됩니다.`

2. **404번 줄**: 게시글 비공개 처리 메시지
   - 변경 전: `신고 누적으로 가려진 게시글입니다. 관리자의 확인 후 복구될 수 있습니다.`
   - 변경 후: `이 콘텐츠는 신고 또는 차단으로 인해 일시적으로 비공개 처리되었습니다. 신고된 콘텐츠는 24시간 내 검토됩니다.`

3. **443번 줄**: 신고 완료 후 alert 메시지
   - 변경 전: `alert(data.message || '신고가 접수되었습니다.');`
   - 변경 후: `alert('이 콘텐츠가 차단되었습니다.\n차단된 콘텐츠는 즉시 숨김 처리되며\n자동으로 신고되어 24시간 내 검토됩니다.');`

4. **461번 줄**: 유효성 검증 alert 메시지
   - 변경 전: `alert('신고 사유를 선택해주세요.');`
   - 변경 후: `alert('신고 또는 차단 사유를 선택해주세요.');`

---

## 원복(롤백) 방법

에러가 발생하거나 원래 상태로 되돌리려면 아래 명령을 실행하세요:

### Windows 명령 프롬프트 (cmd)
```cmd
cd c:\xampp\htdocs\hairwang_server_backup_and_dev\2025_11_27\www

copy /Y bbs\report_form.php.backup bbs\report_form.php
copy /Y skin\board\report_basic\view.skin.php.backup skin\board\report_basic\view.skin.php
copy /Y mobile\skin\board\report_basic\view.skin.php.backup mobile\skin\board\report_basic\view.skin.php

echo 원복 완료!
```

### Git Bash 또는 Linux/Mac
```bash
cd /c/xampp/htdocs/hairwang_server_backup_and_dev/2025_11_27/www

cp bbs/report_form.php.backup bbs/report_form.php
cp skin/board/report_basic/view.skin.php.backup skin/board/report_basic/view.skin.php
cp mobile/skin/board/report_basic/view.skin.php.backup mobile/skin/board/report_basic/view.skin.php

echo "원복 완료!"
```

---

## iOS App Review 제출 시 참고사항

### App Review Notes에 포함할 내용:

```
When a user reports or blocks content, the content is immediately hidden
and replaced with a notice informing the user that it is under review.

All reports are automatically submitted to the developer.
We have an internal admin moderation panel where reported content
is reviewed and acted upon within 24 hours.

Key features:
1. Users can report/block content directly from posts
2. Blocked content is immediately removed from user's view
3. All blocks automatically create a report to administrators
4. All reports are reviewed within 24 hours
5. Admin moderation panel screenshot attached
```

### 제출 시 첨부할 자료:
1. 신고/차단 버튼 클릭 → Alert 메시지 → 즉시 비공개 처리 화면 녹화 영상
2. 관리자 페이지의 신고 리스트 스크린샷

---

## 주의사항

1. **기능 변경 없음**: 이번 수정은 UI 문구만 변경한 것이며, 실제 신고/차단 기능의 동작은 변경되지 않았습니다.
2. **기존 유효성 검증 유지**: `validateReportForm()` 함수는 이미 존재하며 정상 작동합니다.
3. **데이터베이스 변경 없음**: DB 스키마나 데이터는 전혀 수정되지 않았습니다.

---

## 테스트 체크리스트

- [ ] 신고 팝업창이 정상적으로 열리는지 확인
- [ ] 사유 선택 없이 신고 버튼 클릭 시 "신고 사유를 선택해주세요" alert 표시 확인
- [ ] 사유 선택 후 신고 버튼 클릭 시 "이 콘텐츠가 차단되었습니다..." alert 표시 확인
- [ ] Alert 확인 후 해당 게시물이 비공개 처리 안내 메시지로 표시되는지 확인
- [ ] 모바일 버전에서도 동일하게 작동하는지 확인
- [ ] 관리자 계정에서는 신고된 게시물이 보이는지 확인

---

## 문제 발생 시 연락처

문제가 발생하면 백업 파일로 즉시 원복하고, 개발팀에 문의하세요.

백업 파일 위치:
- `bbs/report_form.php.backup`
- `skin/board/report_basic/view.skin.php.backup`
- `mobile/skin/board/report_basic/view.skin.php.backup`
